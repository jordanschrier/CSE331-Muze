<!DOCTYPE html>
<html>
<head>
    <!-- Page Attributes -->
    <title>Submit Inspiration to Muze</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    
    <!-- External References, Stylesheets, and JS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&family=Sometype+Mono:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    
    <!-- Local Stylesheets and JS -->
    <link rel="stylesheet" href="../styles.css">
    <script src="../config.js"></script>
    <script src="../helpers.js"></script>
    <script src="../functions.js"></script>

</head>
<body>
    <nav class="header p-4">
        <!-- Logo -->
        <a href="../"><img class="logo" src="../assets/muse_vector.svg" alt="Muze Logo"></a>
        
        <!-- Search -->
        <input type="text" class="search-bar" placeholder="Search Muze">
        
        <!-- Icons -->
        <div class="nav-links"><!--
            --><a class="nav-icon" href="../forums/"><img src="../assets/forum-icon.svg" alt="Forums"><span>Forums</span></a><!--
            --><a class="nav-icon" href="../"><img src="../assets/inspo-icon.svg" alt="Inspiration"><span>Find Inspo</span></a><!--
            --><a class="nav-icon" href="../profile/"><img src="../assets/profile-icon.svg" alt="Profile"></a>
        </div>
    </nav>

    <div class="content">
        <form name="uploader" id="uploader" enctype="multipart/form-data" class="image-upload-container">
            <h1>Create Inspiration</h1>
            
            <!-- Image Upload -->
            <div class="upload-area" id="uploadArea">
                <img id="image-preview" alt="Image preview">
                <div id="upload-text">
                    <img src="../assets/upload-icon.svg" width="30px" alt="Upload icon">
                    <p>Drag or Upload media</p>
                </div>
                <input type="file" id="file-input" name="fupload" accept="image/*">
            </div>
            
            <!-- Tags -->
            <div class="tags-container">
                <input type="text" id="tag1" name="tag1" placeholder="Add a tag">
                <input type="text" id="tag2" name="tag2" placeholder="Add a tag">
            </div>

            <!-- Text Desc -->
            <textarea rows="6" id="description" name="description" placeholder="Description"></textarea>
            
            <div id="post-button-container">
                <div class="progress-circle" id="progressCircle"></div>
                <input id="post-button" type="button" value="Post">
            </div>
            <!-- <progress value="" max=""></progress> -->
        </form>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('file-input');
            const imagePreview = document.getElementById('image-preview');
            const uploadText = document.getElementById('upload-text');
            const circle = document.getElementById('progressCircle');

            // Click to upload
            uploadArea.addEventListener('click', function() {
                fileInput.click();
            });
            
            // Handle file selection
            fileInput.addEventListener('change', function(e) {
                handleFiles(e.target.files);
            });
            
            // Drag and drop events
            uploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                uploadArea.classList.add('drag-over');
            });
            
            uploadArea.addEventListener('dragleave', function() {
                uploadArea.classList.remove('drag-over');
            });
            
            uploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                uploadArea.classList.remove('drag-over');
                
                if (e.dataTransfer.files.length) {
                    handleFiles(e.dataTransfer.files);
                }
            });
            
            // File handling validation
            function handleFiles(files) {
                const file = files[0];
                
                // Check file size (10MB limit)
                if (file.size > 10485760) {
                    alert('Max upload size is 10 MB.');
                    return;
                }
                
                // Check if it's an image
                if (!file.type.startsWith('image/')) {
                    alert('Please select an image file.');
                    return;
                }
                
                // Preview image
                const reader = new FileReader();
                reader.onload = function(e) {
                    imagePreview.src = e.target.result;
                    imagePreview.style.display = 'inline';
                    uploadText.style.display = 'none';
                    uploadArea.style.border = 'none';
                };
                reader.readAsDataURL(file);
            }
            
            $(':button').on('click', uploadFunction);
            
        });

    </script>
</body>
</html>